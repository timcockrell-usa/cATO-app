"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.overallZTAMaturity = exports.ztaPillars = exports.ztaActivitiesFromCSV = void 0;
exports.ztaActivitiesFromCSV = [
    // User Pillar Activities
    {
        id: 'USER-1.1.1',
        pillar: 'User',
        capabilityId: '1.1',
        capabilityName: 'User Inventory',
        activityId: '1.1.1',
        activityName: 'Inventory User Accounts',
        phaseLevel: 'Target',
        description: 'DoD Components inventory all user accounts and integrate them into the Component\'s identity management solution.',
        azureImplementation: 'Use Microsoft Entra ID as the central identity provider. For hybrid environments, use Microsoft Entra Connect to synchronize on-premises identities. The \'Identities\' blade in the Microsoft Defender XDR portal provides a consolidated inventory.',
        status: 'complete',
        maturity: 90,
        lastUpdated: '2024-11-30',
        updatedBy: 'Identity Team',
        mappedControls: ['AC-2', 'IA-2', 'IA-4'],
    },
    {
        id: 'USER-1.2.1',
        pillar: 'User',
        capabilityId: '1.2',
        capabilityName: 'Conditional Access',
        activityId: '1.2.1',
        activityName: 'Implement App Based Permissions per Enterprise Rule Based Dynamic Access Pt1',
        phaseLevel: 'Target',
        description: 'DoD Components implement application-based permissions for access to applications and resources.',
        azureImplementation: 'Use Microsoft Entra Conditional Access to create application-specific policies that enforce controls like requiring MFA and access from trusted locations.',
        status: 'in-progress',
        maturity: 70,
        lastUpdated: '2024-11-25',
        updatedBy: 'Security Team',
        mappedControls: ['AC-3', 'AC-4'],
    },
    {
        id: 'USER-1.2.2',
        pillar: 'User',
        capabilityId: '1.2',
        capabilityName: 'Conditional Access',
        activityId: '1.2.2',
        activityName: 'Implement App Based Permissions per Enterprise Rule Based Dynamic Access Pt2',
        phaseLevel: 'Advanced',
        description: 'DoD Components expand application-based permissions to include dynamic access rules based on user attributes and context.',
        azureImplementation: 'Enhance Conditional Access policies to use dynamic signals, such as real-time user/sign-in risk from Microsoft Entra ID Protection and device compliance status from Microsoft Intune.',
        status: 'planned',
        maturity: 30,
        lastUpdated: '2024-11-20',
        updatedBy: 'Security Architect',
        mappedControls: ['AC-3', 'IA-8'],
    },
    {
        id: 'USER-1.3.1',
        pillar: 'User',
        capabilityId: '1.3',
        capabilityName: 'Multi-Factor Authentication (MFA)',
        activityId: '1.3.1',
        activityName: 'Enforce Phishing-Resistant MFA',
        phaseLevel: 'Target',
        description: 'DoD Components enforce phishing-resistant MFA for all users accessing agency systems.',
        azureImplementation: 'In Microsoft Entra ID, use \'Authentication Strengths\' to define and enforce phishing-resistant MFA (FIDO2 keys, Windows Hello for Business, Certificate-Based Authentication) via Conditional Access policies.',
        status: 'complete',
        maturity: 95,
        lastUpdated: '2024-12-01',
        updatedBy: 'Identity Team',
        mappedControls: ['IA-2', 'IA-5'],
    },
    {
        id: 'USER-1.4.1',
        pillar: 'User',
        capabilityId: '1.4',
        capabilityName: 'Privileged Access Management (PAM)',
        activityId: '1.4.1',
        activityName: 'Implement Privileged Access Management (PAM) Solution',
        phaseLevel: 'Target',
        description: 'DoD Components implement a PAM solution to manage and audit privileged access.',
        azureImplementation: 'Deploy Microsoft Entra Privileged Identity Management (PIM). Convert all standing privileged roles to \'eligible\' assignments that require just-in-time (JIT) activation with MFA and justification.',
        status: 'complete',
        maturity: 85,
        lastUpdated: '2024-11-28',
        updatedBy: 'Privileged Access Team',
        mappedControls: ['AC-2', 'AC-6'],
    },
    {
        id: 'USER-1.4.2',
        pillar: 'User',
        capabilityId: '1.4',
        capabilityName: 'Privileged Access Management (PAM)',
        activityId: '1.4.2',
        activityName: 'Automate Privileged Access Reviews',
        phaseLevel: 'Advanced',
        description: 'DoD Components automate the review and certification of privileged access rights.',
        azureImplementation: 'Use Microsoft Entra ID Governance Access Reviews to create recurring review campaigns for all privileged roles. Configure reviews to automatically remove access for users who are denied or do not respond.',
        status: 'in-progress',
        maturity: 60,
        lastUpdated: '2024-11-15',
        updatedBy: 'Governance Team',
        mappedControls: ['AC-2', 'AC-6'],
    },
    // Device Pillar Activities
    {
        id: 'DEVICE-2.1.1',
        pillar: 'Device',
        capabilityId: '2.1',
        capabilityName: 'Device Inventory',
        activityId: '2.1.1',
        activityName: 'Inventory All Devices',
        phaseLevel: 'Target',
        description: 'DoD Components maintain a comprehensive inventory of all devices connected to their networks.',
        azureImplementation: 'Enroll all corporate and approved BYOD devices in Microsoft Intune. The \'Devices\' blade in the Intune admin center provides a real-time, comprehensive inventory of all managed devices, including compliance status and OS version.',
        status: 'complete',
        maturity: 88,
        lastUpdated: '2024-11-30',
        updatedBy: 'Device Management Team',
        mappedControls: ['CM-8', 'IA-3'],
    },
    {
        id: 'DEVICE-2.2.1',
        pillar: 'Device',
        capabilityId: '2.2',
        capabilityName: 'Secure Device Configuration',
        activityId: '2.2.1',
        activityName: 'Enforce Secure Configurations on Devices',
        phaseLevel: 'Target',
        description: 'DoD Components enforce secure configuration baselines on all devices.',
        azureImplementation: 'In Microsoft Intune, apply Security Baselines for Windows, macOS, and Edge. Create custom Configuration Profiles to enforce specific settings like full disk encryption (BitLocker/FileVault). Create Compliance Policies to verify these settings are in place.',
        status: 'in-progress',
        maturity: 75,
        lastUpdated: '2024-11-25',
        updatedBy: 'Security Configuration Team',
        mappedControls: ['CM-6', 'SC-28'],
    },
    {
        id: 'DEVICE-2.3.1',
        pillar: 'Device',
        capabilityId: '2.3',
        capabilityName: 'Device Threat Protection',
        activityId: '2.3.1',
        activityName: 'Deploy Endpoint Detection and Response (EDR)',
        phaseLevel: 'Target',
        description: 'DoD Components deploy EDR solutions on all endpoints to detect and respond to threats.',
        azureImplementation: 'Onboard all endpoints to Microsoft Defender for Endpoint. Configure endpoint security policies to ensure EDR is in \'block mode\' and all threat protection features are enabled. Ingest Defender for Endpoint alerts into Microsoft Sentinel.',
        status: 'complete',
        maturity: 92,
        lastUpdated: '2024-12-01',
        updatedBy: 'Endpoint Security Team',
        mappedControls: ['SI-4', 'IR-4'],
    },
    // Applications and Workloads Pillar Activities
    {
        id: 'APPS-3.1.1',
        pillar: 'Applications and Workloads',
        capabilityId: '3.1',
        capabilityName: 'Application Inventory',
        activityId: '3.1.1',
        activityName: 'Inventory All Applications',
        phaseLevel: 'Target',
        description: 'DoD Components maintain a comprehensive inventory of all applications and their components.',
        azureImplementation: 'Use Microsoft Defender for Cloud Apps to discover all SaaS applications in use (\'Shadow IT\'). The \'Enterprise applications\' blade in Microsoft Entra ID provides a complete inventory of all applications integrated for single sign-on.',
        status: 'in-progress',
        maturity: 65,
        lastUpdated: '2024-11-20',
        updatedBy: 'Application Security Team',
        mappedControls: ['CM-8', 'SA-9'],
    },
    {
        id: 'APPS-3.2.1',
        pillar: 'Applications and Workloads',
        capabilityId: '3.2',
        capabilityName: 'Secure Application Development',
        activityId: '3.2.1',
        activityName: 'Integrate Security into DevOps (DevSecOps)',
        phaseLevel: 'Target',
        description: 'DoD Components integrate security testing and code analysis into their application development pipelines.',
        azureImplementation: 'In Azure DevOps or GitHub Actions, integrate security scanning into the CI/CD pipeline. This includes Static Application Security Testing (SAST) with tools like GitHub CodeQL and Software Composition Analysis (SCA) to scan for vulnerabilities in open-source dependencies.',
        status: 'in-progress',
        maturity: 70,
        lastUpdated: '2024-11-18',
        updatedBy: 'DevSecOps Team',
        mappedControls: ['SA-11', 'SA-15'],
    },
    // Data Pillar Activities
    {
        id: 'DATA-4.1.1',
        pillar: 'Data',
        capabilityId: '4.1',
        capabilityName: 'Data Catalog Risk Alignment',
        activityId: '4.1.1',
        activityName: 'Catalog and Classify Data',
        phaseLevel: 'Target',
        description: 'DoD Components catalog and classify their data based on sensitivity and criticality.',
        azureImplementation: 'Deploy Microsoft Purview and configure it to scan all relevant data sources (Azure SQL, Azure Storage, etc.). Leverage Purview\'s built-in and custom classifiers to automatically identify and classify sensitive data types like PII and CUI.',
        status: 'planned',
        maturity: 40,
        lastUpdated: '2024-11-10',
        updatedBy: 'Data Governance Team',
        mappedControls: ['SC-16', 'MP-3'],
    },
    {
        id: 'DATA-4.3.1',
        pillar: 'Data',
        capabilityId: '4.3',
        capabilityName: 'Data Labeling and Tagging',
        activityId: '4.3.1',
        activityName: 'Implement Data Tagging & Classification Tools',
        phaseLevel: 'Target',
        description: 'DoD Components implement tools for automated data tagging and classification.',
        azureImplementation: 'In the Microsoft Purview compliance portal, create Sensitivity Labels corresponding to the organization\'s classification levels. Create auto-labeling policies to automatically apply these labels to files and emails in Microsoft 365 when sensitive content is detected.',
        status: 'planned',
        maturity: 35,
        lastUpdated: '2024-11-05',
        updatedBy: 'Information Protection Team',
        mappedControls: ['SC-16', 'MP-3'],
    },
    // Network and Environment Pillar Activities
    {
        id: 'NETWORK-5.1.1',
        pillar: 'Network and Environment',
        capabilityId: '5.1',
        capabilityName: 'Network Segmentation',
        activityId: '5.1.1',
        activityName: 'Implement Macro and Micro-Segmentation',
        phaseLevel: 'Target',
        description: 'DoD Components implement network segmentation to isolate critical systems and data.',
        azureImplementation: 'Implement a hub-spoke virtual network topology (macro-segmentation). Apply Network Security Groups (NSGs) with deny-by-default rules to all subnets to create isolated segments for different application tiers (micro-segmentation).',
        status: 'in-progress',
        maturity: 55,
        lastUpdated: '2024-11-22',
        updatedBy: 'Network Security Team',
        mappedControls: ['SC-7', 'AC-4'],
    },
    {
        id: 'NETWORK-5.2.1',
        pillar: 'Network and Environment',
        capabilityId: '5.2',
        capabilityName: 'Network Traffic Encryption',
        activityId: '5.2.1',
        activityName: 'Encrypt All Network Traffic',
        phaseLevel: 'Target',
        description: 'DoD Components encrypt all network traffic, both internal and external.',
        azureImplementation: 'Use Azure VPN Gateway or ExpressRoute with MACsec to encrypt traffic between on-premises and Azure. Traffic between peered VNets in the same region is encrypted by default. Use Private Endpoints to ensure traffic to PaaS services remains on the encrypted Microsoft backbone.',
        status: 'complete',
        maturity: 90,
        lastUpdated: '2024-11-28',
        updatedBy: 'Network Team',
        mappedControls: ['SC-8', 'SC-13'],
    },
    // Automation and Orchestration Pillar Activities
    {
        id: 'AUTO-6.1.1',
        pillar: 'Automation and Orchestration',
        capabilityId: '6.1',
        capabilityName: 'Policy Decision Point (PDP) & Policy Orchestration',
        activityId: '6.1.1',
        activityName: 'Establish Centralized Policy Management',
        phaseLevel: 'Target',
        description: 'DoD Components establish a centralized policy management framework for consistent policy enforcement.',
        azureImplementation: 'Use Azure Management Groups to structure the Azure environment. Assign Azure Policy initiatives (like the Microsoft Cloud Security Benchmark) to the top-level management group to ensure consistent application of governance and security rules to all subscriptions.',
        status: 'complete',
        maturity: 85,
        lastUpdated: '2024-11-30',
        updatedBy: 'Governance Team',
        mappedControls: ['AC-3', 'CM-7'],
    },
    {
        id: 'AUTO-6.2.1',
        pillar: 'Automation and Orchestration',
        capabilityId: '6.2',
        capabilityName: 'Security Orchestration, Automation, and Response (SOAR)',
        activityId: '6.2.1',
        activityName: 'Implement SOAR Platform',
        phaseLevel: 'Target',
        description: 'DoD Components implement a SOAR platform to automate incident response and security operations.',
        azureImplementation: 'Utilize the built-in SOAR capabilities of Microsoft Sentinel, which are powered by Azure Logic Apps. Create Automation Rules and Playbooks to automate common incident response tasks like blocking a malicious IP or disabling a user account.',
        status: 'in-progress',
        maturity: 60,
        lastUpdated: '2024-11-15',
        updatedBy: 'SOC Team',
        mappedControls: ['IR-4', 'IR-8'],
    },
    // Visibility and Analytics Pillar Activities
    {
        id: 'VISIBILITY-7.1.1',
        pillar: 'Visibility and Analytics',
        capabilityId: '7.1',
        capabilityName: 'Log All Traffic',
        activityId: '7.1.1',
        activityName: 'Centralize Logging and Monitoring',
        phaseLevel: 'Target',
        description: 'DoD Components centralize logging and monitoring of all network, data, application, and user activity.',
        azureImplementation: 'Deploy a central Log Analytics workspace. Use Azure Policy to enforce that Diagnostic Settings for all Azure resources are configured to send all logs to this central workspace. Use Microsoft Sentinel data connectors to ingest logs from all other sources.',
        status: 'complete',
        maturity: 88,
        lastUpdated: '2024-12-01',
        updatedBy: 'Logging Team',
        mappedControls: ['AU-2', 'AU-3', 'SI-4'],
    },
];
// Group activities by pillar for easier access
exports.ztaPillars = [
    {
        id: 'user',
        name: 'User',
        description: 'User and entity identity verification and access control',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'User'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'User'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'User'; }),
    },
    {
        id: 'device',
        name: 'Device',
        description: 'Device trust and compliance verification',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Device'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Device'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Device'; }),
    },
    {
        id: 'applications',
        name: 'Applications and Workloads',
        description: 'Application security and workload protection',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Applications and Workloads'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Applications and Workloads'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Applications and Workloads'; }),
    },
    {
        id: 'data',
        name: 'Data',
        description: 'Data protection and governance',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Data'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Data'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Data'; }),
    },
    {
        id: 'network',
        name: 'Network and Environment',
        description: 'Network security and infrastructure protection',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Network and Environment'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Network and Environment'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Network and Environment'; }),
    },
    {
        id: 'automation',
        name: 'Automation and Orchestration',
        description: 'Automated policy enforcement and response',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Automation and Orchestration'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Automation and Orchestration'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Automation and Orchestration'; }),
    },
    {
        id: 'visibility',
        name: 'Visibility and Analytics',
        description: 'Comprehensive monitoring and threat detection',
        maturity: Math.round(exports.ztaActivitiesFromCSV
            .filter(function (a) { return a.pillar === 'Visibility and Analytics'; })
            .reduce(function (sum, a) { return sum + a.maturity; }, 0) /
            exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Visibility and Analytics'; }).length),
        activities: exports.ztaActivitiesFromCSV.filter(function (a) { return a.pillar === 'Visibility and Analytics'; }),
    },
];
// Calculate overall ZTA maturity
exports.overallZTAMaturity = Math.round(exports.ztaActivitiesFromCSV.reduce(function (sum, a) { return sum + a.maturity; }, 0) / exports.ztaActivitiesFromCSV.length);
